using DocTransAppBeta1.MarkupParser;
using DocTransAppBeta1.PdfStructure;
using QuestPDF.Infrastructure;
using RtfPipe;
using System.Data.Common;
using System.Text;
using System.Xml.Serialization;

namespace DocTransAppBeta1
{
    internal static class Program
    {
        /// <summary>
        ///  The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main()
        {
            // To customize application configuration such as set high DPI settings or default font,
            // see https://aka.ms/applicationconfiguration.
            QuestPDF.Settings.License = LicenseType.Community;
            QuestPDF.Settings.CheckIfAllTextGlyphsAreAvailable = false;
            QuestPDF.Settings.FontDiscoveryPaths.Add("C:\\Windows\\Fonts");

            //DocTransObjSerializer ser = new DocTransObjSerializer();
            //string s = File.OpenText("C:\\Users\\56279\\Desktop\\pages\\page10.xml").ReadToEnd();
            //var obj = ser.PageDeserialize(s);

            //{\rtf1\ansi\ansicpg936\deff0\nouicompat{\fonttbl{\f0\fnil\fcharset134 Microsoft YaHei UI;}} {\colortbl ;\red255\green0\blue255;} {\*\generator Riched20 10.0.26100}\viewkind4\uc1 \pard\f0\fs18\lang2052 BERT\'a3\'ba\i\'d4\'a4\'d1\'b5\i0\'c1\'b7\'c9\'ee\b\'b6\'c8\'cb\'ab\b0\'cf\'f2\'d7\'aa\'bb\'bb\cf1\'c6\'f7\'d2\'d4\'ca\'b5\'cf\'d6\cf0\'d3\'ef\'d1\'d4\'c0\'ed{\pict{\*\picprop{\sp{\sn wzDescription}{\sv Image}}{\sp{\sn posv}{\sv 1}} }\pngblip\picw3449\pich2674\picwgoal1955\pichgoal1516 89504e470d0a1a0a0000000d4948445200000081000000640806000000a1295361000000017352474200aece1ce90000000467414d410000b18f0bfc6105000000097048597300000ec300000ec301c76fa8640000026449444154785eeddc316a1b511440d12b8d70a146421a837025f02ab28394de84c095bbec207d206d76e05e605c1bdc6a032adc18c60c9250a142ccc8299214f9c44a42fce70ff13de57b0215baccab469dcd66f38cdeb46e38d0db6304320219818c40188130026104c208841108231046208c40188130026104c208841108231046208c40188130026104c208841108231046208c40188130026104c208841108231046208c40188130026104c20804d0592c16fea36904fd7e9fd16844afd70b578da8aa8ab22cd9eff71c0e8770fd934e5dd746f0ca0e8703abd58aa228383b3b6b3c84aaaa787c7ce4f4f4943ccfe9768f3ff08d20a2a228d86eb74c26937015d5d3d313c3e190f1781cae7ee97822fa27799eb3dfefc37174bbdd8ee170188e5f6404116559f6db7b1c4b9665e1e8454620239011c808441b23b8b9ccc8b24b6ec285a2695704cbcf7cfc02cc2e781fee144dab2258ceafb907661726d0a41645b0647e7d0fccb08166b52782e59c6f0d780a9ad69a083c05e9b4 24024f414aed88c05390542b22f014a4d582083c05a9a58fc053905cf2083c05e9258ec053d006 6923f87e0ade7dfae02948286d04e757dcd5357757e7e1460d4a1b815ac1086404320219415c75 5d87a34674bbddbffa6e238868bd5ed3eff7c371742727279465198e5f640411d4754d51141445 c168340ad7d1e5794e59969465f9474f84ceededad2fa4beb22ccb180c064ca7d3c6df48fea1aa 2a1e1e1e58ad563c3f1fff893b9bcde6f827f4dff31cc808640432026104c20884110823104620 8c40188130026104c208841108231046208c40188130026104c2088411082310462080af2a0ea8446fde33320000000049454e44ae426082}\'bd\'e2\par }
            //{\\rtf1\\ansi\\deff0\\nouicompat{\\fonttbl{\\f0\\fnil\\fcharset134 Microsoft YaHei UI;}}\r\n{\\colortbl ;\\red255\\green0\\blue255;}\r\n{\\*\\generator Riched20 10.0.26100}\\viewkind4\\uc1 \r\n\\pard\\b\\f0\\fs18\\lang2052 BERT\\b0\\'a3\\'ba\\'c9\\'ee\\'b6\\'c8\\cf1\\'cb\\'ab\\'cf\\'f2\\'b1\\'e4\\cf0\\'bb\\'bb\\'c6\\'f7\\i\\'d4\\'a4\\i0\\'d1\\'b5\\strike\\'c1\\'b7\\'b6\\'d4\\strike0\\'d3\\'da\\ul\\'d3\\'ef\\'d1\\'d4\\ulnone\\'c0\\'ed\\'bd\\'e2\\par\r\n}
            Encoding.RegisterProvider(CodePagesEncodingProvider.Instance);
            RtfPipe.Parser psr = new Parser("{\\rtf1\\ansi\\ansicpg936\\deff0\\nouicompat\\deflang1033\\deflangfe2052{\\fonttbl{\\f0\\fswiss\\fcharset0 Calibri;}{\\f1\\fswiss\\fcharset134 \\'ce\\'a2\\'c8\\'ed\\'d1\\'c5\\'ba\\'da;}{\\f2\\fnil\\fcharset134 Microsoft YaHei UI;}}\r\n{\\*\\generator Riched20 10.0.26100}\\viewkind4\\uc1 \r\n\\pard\\f0\\fs18 sffaf{\\pict{\\*\\picprop{\\sp{\\sn wzDescription}{\\sv Image}}{\\sp{\\sn posv}{\\sv 1}}\r\n}\\pngblip\\picw2941\\pich1043\\picwgoal1667\\pichgoal591 \r\n89504e470d0a1a0a0000000d494844520000006e000000270806000000ee0c7d5f000000017352\r\n474200aece1ce90000000467414d410000b18f0bfc6105000000097048597300000ec300000ec3\r\n01c76fa8640000047f49444154785eed9a4f481c571cc7bf6f9ba9874a36c2143a092eb5273dcc\r\nc12da506b714dbe6d02a544405a5a1a1197ae8217ff02282b0208897107229a4dd2d8237114921\r\n3687404e8a5b4ad3c306da4b9c68d10ded82d9e2c5ae99d7439d61e6b7b3b333ebd49dedbe0f3c\r\nd679ff5cdf67e6fd7e6f5776f7db2c1f9ff80c82e8c38e5f3900b67f70c849bb208298d24c62e4\r\n5ad0047021ae7930b745f355888b10743ba4d8639a1017114c69b5e499087111c0af2c3b27ce2a\r\n1903623068754d0ccec0eb7acbff1fdcfe7abf324e2e0e1c528ce3afd20b944a25da5c81244990\r\n6519ecccab78c95bf781a7d2824a084ddc0f6bf7b1b6b6469b2b5014059aa6e1f537ceb7ac382a\r\n0d75880b6de54aa5127676766a9642a18072b94c87b73441a5b130c509bc61b662278834fbf8a6\r\n10b7bab28c8ef636d7f24cd769f74870e7f62ddcb97d0b709185636141a5d9f1258e81e3156654\r\n29007890b7503fbfe47fc3fec1a1a3bcd9d545bb359ca4da83f4ec0cadae1b2a0d7ec5c518073f\r\nfa1b7f3edfc3deefdb8ef2c7f35d1c1d89980500a3c343e8686f83ae6f39eae96d4daf83c2fd8a\r\n038062b1884c268385850547c9643228168bb47b4bb2f5f429d273f3d83f38a44d159f35fac12b\r\n26fa16572e97512814229d253ed3f58a18b8bab2ece893dbdc40477b1b729b1b48aa3de8686fb3\r\n6291f9f3d48d6bd6f8a4dae33ab739c6cee3fcafb87e738a565b04956687c644dfe2a2ceeaca32\r\n7ad56e641797acf8f7e0e1235cbd72195337aed1eef8ea4b0d5f7f93c1fec1a163b1d3b333e84f\r\na5ac39747d0b49b507bd6ab755975d5c427a7606b9cd0dc79c6141a5b9d154e27ad56ec75d3f3a\r\n3c64b55dbd7219e9b9798c8c8e5b757d17fb915d5cc27799bb15d9e7e75f68e8bbd8efa803800f\r\n3fbae498233d370f5ddf427671c9aa1b191d4757d75bf83197b3eafe4bdc9ed4d0c4a9aa8ac9c9\r\nc99a65707010f1789c0ef705cd2a57eedd078eb73f00f87478848c00926fbf030078fcf34f8efa\r\n77fbfa1cd726efbd3fe0b8eeecec046cf3d8d9d9dea65581b09fed829ef34213974824904aa55c\r\ncbc0c000c6c6c6303131894f068770367e8e0e3f117bbbbbb4ca228ac705b808a2d09846094ddc\r\nfafa7a45c649334f0331940d86b2c16084f7ab71fec2055a6541b7c828504b9a1f425b3dafcf2a\r\ncdcc938383e3dfaf73c23cb39bb1eafb7babb4c9da22ed71ab919c549ab99dfa16274912144541\r\n229170144551204912ed7eeaa4e7e6919e9d71a4ffb9cd0d2b6969346ef1ab1ad5ee69fb78dfe2\r\n645986a669989e9e76144dd320cb32ed7eea5cbf3965a5ff66d6f9f1a50ff0e0e123cfb3d569e0\r\n579817740e5fdfc73170c4987b370686180c3c7992473e9fa7cd0080783c8e542a85d7ce9e6bc9\r\nefe0e8a27be1b6ca6ee37d89f386e30c3310636ed33b79c921c479e026a2dad810c401f0fbdf23\r\n2cdca4a4d9a8b546f6a5a9d537a4dbff3853ac555a581a6c6733b7335a1069084f9ca01eaa49f4\r\n83101731fc3c6d10e2a24390731e84b8681044988910d76498f150886b22b8ede914e21a8419d3\r\n826c93f6be425c030822ab1a425c84a00774af339e101771aa3d9dff0004d2f6e4e632c4050000\r\n000049454e44ae426082\r\n}\\f1\\lang2052\\'ce\\'d2\\'b6\\'a5\\'ce\\'d2\\'b6\\'a5\\'ce\\'d2\\'b6\\'a5\\f2\\par\r\n}");
            Document doc = psr.Parse();
            var v = doc.Contents;


            string s = "{\\rtf1\\ansi\\deff0\\nouicompat{\\fonttbl{\\f0\\fnil\\fcharset134 Microsoft YaHei UI;}}\r\n{\\colortbl ;\\red255\\green0\\blue255;\\red255\\green0\\blue0;\\red0\\green255\\blue0;}\r\n{\\*\\generator Riched20 10.0.26100}\\viewkind4\\uc1 \r\n\\pard\\f0\\fs18\\lang2052\\'d3\\'d0\\'c1\\'bd\\'d6\\'d6\\b\\'cf\\'d6\\'d3\\'d0\\'b5\\'c4\\'b2\\'df\\'c2\\'d4\\b0\\'d3\\'c3\\i\\'d3\\'da\\'bd\\'ab\\'d4\\'a4\\'d1\\'b5\\'c1\\'b7\\i0\\'b5\\'c4\\'d3\\'ef\\'d1\\'d4\\'b1\\'ed\\'ca\\'be\\'d3\\'a6\\'d3\\'c3\\'d3\\'da\\'cf\\'c2\\'d3\\'ce\\'c8\\'ce\\'ce\\'f1\\'a3\\'ba\\'bb\\'f9\\'d3\\'da\\'cc\\'d8\\'d5\\'f7\\'b5\\'c4\\'b7\\'bd\\'b7\\'a8\\ul\\'ba\\'cd\\'ce\\'a2\\'b5\\'f7\\'b7\\'bd\\'b7\\'a8\\ulnone\\b\\'a1\\'a3\\'c0\\'fd\\'c8\\'e7ELMo\\'a3\\'a8\\cf1 Peters et al., 2018a\\cf0\\'a3\\'a9\\'b5\\'c4\\'bb\\'f9\\'d3\\'da\\'cc\\'d8\\'d5\\'f7\\'b5\\'c4\\'b7\\'bd\\'b7\\'a8\\'ca\\'b9\\'d3\\'c3\\'b0\\'fc\\'ba\\'ac\\'d4\\'a4\\'d1\\'b5\\b0\\'c1\\'b7\\'b1\\'ed\\ul\\'ca\\'be\\'d7\\'f7\\'ce\\'aa\\'b8\\'bd\\'bc\\'d3\\'cc\\'d8\\'d5\\'f7\\'b5\\'c4\\'c8\\'ce\\'ce\\'f1\\'cc\\'d8\\'b6\\'a8\\'bc\\'dc\\'b9\\'b9\\'a1\\'a3\\'b6\\'f8\\'ce\\'a2\\'b5\\'f7\\'b7\\'bd\\'b7\\'a8\\'a3\\'ac\\'c0\\'fd\\'c8\\'e7\\'c9\\'fa\\'b3\\'c9{\\pict{\\*\\picprop{\\sp{\\sn wzDescription}{\\sv Image}}{\\sp{\\sn posv}{\\sv 1}}\r\n}\\pngblip\\picw3663\\pich856\\picwgoal2077\\pichgoal485 \r\n89504e470d0a1a0a0000000d494844520000008900000020080600000026375bef000000017352\r\n474200aece1ce90000000467414d410000b18f0bfc6105000000097048597300000ec300000ec3\r\n01c76fa864000003c949444154785eed5abb6de430101d1f4b31ee027740600b30e0e422772060\r\nd3ab44c04607b803474e086c079b3aba40c6f6e006083ad08f9a7943cabbb283c33ce0051a529c\r\n0f1f395ad837efefef890c86026e5e5f5f4d2486226e628c261243113fb8c160e0309118aa3091\r\n18aa309118aa309118aa309118aa309118aab8402447da3b476e77a0331fca703eecc83947bbc3\r\n9988ce74d839726e4f473ef10b71dc3b720ef1d23886dc9d23e776743853965bce718cbdbdd7c7\r\n7aacabedb658b13731c6f43986d41025f26deac4d8c0ae4d9e285113f0f3b75089738c85db634c\r\n313489c8a7b6e36b8d63947cdb89b59a00fc8a7594786a3e263b5f6f23aed89b2f1049975a4f89\r\na849418c7d23b582abf10d769817ceb90b01cc8da96b7d222e1e359e99a141e22ac5753d61ac8c\r\n17b49b328efb5ff4e7e4a9edfed23d1ffc461c5f9e88c8d3e3c32d1b79a37f2722f277f433379f\r\n033d9f88fce303f137e8f8424f24c76eefefe55c227aeb1dd05de6408f67c491fa298fb498528a\r\neb6a9c293c9f88a8a1dfa5cde2aaa9139faa1895d352b8ce46154fcce7a0b50aca5f9ec27a8cd3\r\nfbc3b36013d431ee7bc9c1f7225f64c3714df92abe790bf76d27ea38aea1d92716f626e78622c1\r\n76bca9602e2b127c6f4c8adb958d1745417e8bf6da18e7d8ca58cbe0f101e256a3fbce0530e539\r\nd5c727eff3fc718b853506dc4c243849d44f9553c5542d1318d7f2c92ffcc8f5602cd50f5624aa\r\n751bdc73dc0839b78f6705796c6a5c8a18ab31e422c1c241dc46245a32d995d8db9068f0dc5e24\r\n7311fae72685d0603b8f8f13f91c0845b5182b17723ed5680d296241a57e6a5ca2aecc97c815d4\r\n7d65ab89db88843fcfe41badf6d9897cf397df184d18d718eca858a2e0daa9d3f201635a21f37c\r\ne0fbeb6e222c063d2e51d79a2f5027750dc0ab4582138c50bdfa5cc9fc048786b7a1ccbea6ed09\r\ne17c6e4c143dbbd66bb74cfd2652c4a0c625eb5af32505a1af81789d48d42222f5aeef81314f58\r\n6b2fcc2e6203b108bb262a1ec3c23eb73398379aabdd445117831a97a86bcd171084ba06e61522\r\nf1c59ea6aa57141db3bf259ad42cbed2e7e2790f7caba2d55a8e22aa7c6ce1435b47a11acf4c2c\r\n063d2e59d78a2f2008750d85978ba478d502f54e05e10aeee72e93cbae73650de41b9ffce57b4b\r\n3ffa66c0a2235b81a5787a222166761117ae6bc9971484be86c6ab44a2160ba8b767decb472245\r\neb27166f762c147ce0f891c9c667d1a19fd179d151ec9c79bc9578b298642e4a5c4a6bd27fa900\r\n41a87ba3d3fe5bde50c5e67fbb31fc7f309118aa309118aa309118aa309118aa309118aa309118\r\naaf800219bcf99df5bbf700000000049454e44ae426082\r\n}\\'d4\\'a4\\'d1\\'b5\\'c1\\'b7\\'b5\\'c4Transformer\\ulnone\\'a3\\'a8\\cf1 OpenAI GPT\\cf0\\'a3\\'a9\\'a3\\'a8\\cf2 Radford et al., 2018\\cf0\\'a3\\'a9\\'a3\\'ac\\'d2\\'fd\\'c8\\'eb\\'c1\\'cb\\'bc\\'ab\\'c9\\'d9\\'c1\\'bf\\'b5\\'c4\\'c8\\'ce\\'ce\\'f1\\'cc\\'d8\\'b6\\'a8\\'b2\\'ce\\'ca\\'fd\\'a3\\'ac\\'b2\\'a2\\'cd\\'a8\\'b9\\'fd\\'bc\\'f2\\'b5\\'a5\\'b5\\'d8\\'ce\\'a2\\'b5\\'f7\\'cb\\'f9\\'d3\\'d0\\'d4\\'a4\\'d1\\'b5\\cf3\\'c1\\'b7\\'b2\\'ce\\strike\\'ca\\'fd\\'c0\\'b4\\'d4\\'da\\'cf\\'c2\\'d3\\'ce\\'c8\\'ce\\'ce\\'f1\\'c9\\'cf\\'bd\\'f8\\'d0\\'d0\\'d1\\'b5\\'c1\\'b7\\'a1\\'a3\\'c1\\'bd\\'d6\\'d6\\'b7\\'bd\\'b7\\'a8\\'d4\\'da\\'d4\\'a4\\'d1\\'b5\\'c1\\'b7\\'c6\\'da\\'bc\\'e4\\'b9\\'b2\\'cf\\'ed\\'cf\\'e0\\cf0\\'cd\\'ac\\'b5\\'c4\\strike0\\'bf\\'cd\\'b9\\'db\\'ba\\'af\\'ca\\'fd\\'a3\\'ac\\'d4\\'da\\'b4\\'cb\\'b9\\'fd\\'b3\\'cc\\'d6\\'d0\\'cb\\'fc\\'c3\\'c7\\'ca\\'b9\\'d3\\'c3\\'b5\\'a5\\'cf\\'f2\\'d3\\'ef\\'d1\\'d4\\'c4\\'a3\\'d0\\'cd\\'c0\\'b4\\'d1\\'a7\\'cf\\'b0\\'cd\\'a8\\'d3\\'c3\\'b5\\'c4\\'d3\\'ef\\'d1\\'d4\\'b1\\'ed\\'ca\\'be\\'a1\\'a3\\par\r\n}\r\n";
            IEnumerable<RtfSegment> seg = LocalRtf.RtfStyleParse(s);
            foreach(var i in seg)
            {
                BetaVersionDebugPrinter.WriteLine(i.Content, "0");
            }
            ApplicationConfiguration.Initialize();
            Application.Run(new MainForm());
        }
    }
}